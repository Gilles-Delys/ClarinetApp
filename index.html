<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clarinette Maestro Pro - v3-Fix</title>
    <script src="https://cdn.jsdelivr.net/npm/vexflow@4.2.2/build/cjs/vexflow.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #f0f8ff;
            --panel-bg: #ffffff;
            --primary-color: #d35400;
            --text-color: #2c3e50;
            --gray-contour: #333333;
            --active-red: #ff0000;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0; padding: 20px;
            display: flex; flex-direction: column;
        }

        header {
            background: white; padding: 15px 20px; border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }

        .controls-bar {
            background: white; padding: 15px; border-radius: 8px;
            display: flex; gap: 20px; align-items: center; margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            flex-wrap: wrap;
        }

        .workspace { display: flex; gap: 20px; flex-wrap: wrap; }

        .notation-area, .visual-area {
            background: var(--panel-bg); border-radius: 8px; padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            flex: 1; min-width: 350px;
            text-align: center;
        }

        .tuner-bar-bg {
            width: 100%; height: 25px; background: #ecf0f1; border-radius: 12px;
            position: relative; overflow: hidden; border: 1px solid #bdc3c7; margin: 15px 0;
        }

        .tuner-bar-fill {
            height: 100%; width: 10px; background: var(--primary-color);
            position: absolute; left: 50%; transition: left 0.1s ease-out;
        }

        .cl-contour { fill: none; stroke: var(--gray-contour); stroke-width: 1.5; }
        .cl-hole-bg { fill: #ffffff; stroke: var(--gray-contour); stroke-width: 1.5; }
        .cl-active { fill: var(--active-red) !important; stroke: var(--active-red) !important; }

        #staff-container { min-height: 150px; display: flex; justify-content: center; }

        .btn-primary { background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        .btn-stop { background: #e74c3c; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #bdc3c7; }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-music"></i> Clarinette Maestro</h1>
        <div class="menu-group">
            <label>Mode :</label>
            <select id="main-mode-select">
                <option value="solfege">Solfège (Exercices)</option>
                <option value="partition">Partition (Export)</option>
            </select>
        </div>
    </header>

    <main id="app-container">
        <div class="controls-bar">
            <div class="control-item">
                <label>Difficulté :</label>
                <select id="difficulty-level">
                    <option value="tres-facile">Très facile (Mi3 - La3)</option>
                    <option value="facile" selected>Facile (Mi3 - Do5)</option>
                    <option value="intermediaire">Intermédiaire (Mi3 - Sol5)</option>
                    <option value="difficile">Difficile (Mi3 - Do6)</option>
                    <option value="tres-difficile">Très difficile (Mi3 - Do7)</option>
                </select>
            </div>
            <div class="control-item">
                <label>Altérations :</label>
                <input type="checkbox" id="alterations-check">
            </div>
            <button id="btn-start" class="btn-primary">▶ Commencer la série</button>
            <button id="btn-stop" class="btn-stop" disabled>⬛ Arrêter</button>
        </div>

        <div class="workspace">
            <div class="notation-area">
                <div class="score-display">Note : <span id="progress-count">0</span> / 20</div>
                <div id="staff-container"></div>
                <h2 id="target-note-name">Prêt ?</h2>
                <div class="tuner-box">
                    <div class="tuner-bar-bg">
                        <div id="tuner-bar" class="tuner-bar-fill"></div>
                    </div>
                    <div class="frequency-info">
                        <span id="detected-freq">0</span> Hz | <span id="feedback-message">Attente...</span>
                    </div>
                </div>
            </div>

            <div class="visual-area">
                <h3>Doigté Système Boehm</h3>
                <div id="clarinet-svg-container"></div>
            </div>
        </div>
    </main>

    <footer style="position: fixed; bottom: 0; right: 0; background: rgba(0,0,0,0.5); color: white; padding: 5px; font-size: 10px; z-index: 1000;">
        Version: 2026-02-12_v3-Fix
    </footer>

    <script type="module" src="js/app.js"></script>
</body>
</html>